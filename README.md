# è¦çš®è¨‚å–® ETL è‡ªå‹•åŒ–å°ˆæ¡ˆ (Shopee Orders ETL Automation Project)

**æœ€å¾Œæ›´æ–°æ—¥æœŸï¼š** 2025å¹´6æœˆ7æ—¥

## å°ˆæ¡ˆç°¡ä»‹

æœ¬å°ˆæ¡ˆæ—¨åœ¨æä¾›ä¸€å€‹å…¨è‡ªå‹•åŒ–çš„ETL (Extract, Transform, Load) æµç¨‹ï¼Œç”¨æ–¼è™•ç†å¾è¦çš®è³£å®¶ä¸­å¿ƒä¸‹è¼‰çš„è¨‚å–®Excelå ±è¡¨ã€‚å®ƒæœƒè‡ªå‹•æ¸…æ´—ã€è½‰æ›ã€æ¨™æº–åŒ–è³‡æ–™ï¼Œä¸¦æœ€çµ‚å°‡å…¶ä¸Šå‚³è‡³ Google BigQueryï¼Œä»¥åˆ©å¾ŒçºŒçš„æ•¸æ“šåˆ†æèˆ‡å•†æ¥­æ™ºæ…§å ±å‘Šã€‚

## æ ¸å¿ƒåŠŸèƒ½

- **è‡ªå‹•åŒ–æ¸…æ´—æµç¨‹**ï¼šä¸€éµåŸ·è¡Œæ‰¹æ¬¡æª” (`.bat`) å³å¯å®Œæˆæ‰€æœ‰è³‡æ–™æ¸…æ´—èˆ‡è½‰æ›ã€‚
- **æª”åè³‡è¨Šæ“·å–**ï¼šè‡ªå‹•å¾è¼¸å…¥çš„æª”æ¡ˆåç¨±ä¸­æ“·å–ã€Œåº—é‹ªåç¨±ã€èˆ‡ã€Œåº—é‹ªå¸³è™Ÿã€ï¼Œä¸¦æ–°å¢ç‚ºè³‡æ–™æ¬„ä½ã€‚
- **æ¬„ä½æ¨™æº–åŒ–**ï¼šå°‡æ‰€æœ‰æ¬„ä½åç¨±è½‰æ›ç‚º BigQuery æœ€ä½³å¯¦è¸çš„è‹±æ–‡è›‡å½¢å‘½åæ³• (`snake_case`)ã€‚
- **æ™ºæ…§æ­¸æª”æ©Ÿåˆ¶**ï¼šæˆåŠŸè™•ç†çš„åŸå§‹ Excel æª”æ¡ˆæœƒè‡ªå‹•åŠ ä¸Šæ™‚é–“æˆ³ä¸¦ç§»è‡³ `archive/` è³‡æ–™å¤¾å‚™ä»½ï¼Œé¿å…é‡è¤‡è™•ç†ã€‚
- **è¨­å®šæª”ç®¡ç†**ï¼šæ‰€æœ‰è·¯å¾‘ã€æ¬„ä½å°ç…§ç­‰è¨­å®šçš†ç”± `config.py` çµ±ä¸€ç®¡ç†ï¼Œæ–¹ä¾¿ç¶­è­·ã€‚
- **ä¸€éµä¸Šå‚³é›²ç«¯**ï¼šæä¾›æ‰¹æ¬¡æª”ï¼Œå¯ä¸€éµå°‡æ¸…æ´—å¾Œçš„ CSV ä¸»æª”ä¸Šå‚³è‡³æŒ‡å®šçš„ BigQuery è³‡æ–™è¡¨ã€‚

## ğŸ“‚ å°ˆæ¡ˆçµæ§‹

```
C:/Users/user/Documents/shopee_orders_etl/
â”‚
â”œâ”€ .gitignore          # (å»ºè­°) Gitå¿½ç•¥æ¸…å–®
â”œâ”€ README.md           # æœ¬èªªæ˜æª”æ¡ˆ
â”œâ”€ requirements.txt    # Python å¥—ä»¶ä¾è³´åˆ—è¡¨
â”‚
â”œâ”€ venv/               # Python è™›æ“¬ç’°å¢ƒ
â”œâ”€ input/              # æ”¾ç½®æ‰‹å‹•æ”¹å¥½æª”åã€å¾…æ¸…æ´—çš„ Excel æª”æ¡ˆ
â”œâ”€ output/             # å­˜æ”¾æ¸…æ´—å¾Œè¼¸å‡ºçš„ä¸»æª” A01_master_orders_cleaned.csv
â”œâ”€ archive/            # å­˜æ”¾å·²è™•ç†éçš„åŸå§‹æª”æ¡ˆå‚™ä»½ï¼ˆè‡ªå‹•æ­¸æª”ï¼‰
â”œâ”€ upload_ready/       # (æ‰‹å‹•ç®¡ç†) æº–å‚™ä¸Šå‚³è‡³ BigQuery çš„ CSV æª”æ¡ˆæš«å­˜å€
â”‚
â””â”€ scripts/
   â”œâ”€ shopee-etl-reporting-9531f3a7678a.json # ä¸Šå‚³è‡³ BigQuery çš„ Google API é‡‘é‘°
   â”œâ”€ config.py                             # æ¬„ä½è¨­å®šã€å¸¸æ•¸èˆ‡è·¯å¾‘é…ç½®
   â”œâ”€ order_processing_script.py            # ä¸»è¦ETLè™•ç†æµç¨‹è…³æœ¬
   â”‚
   â””â”€ bat_scripts/
      â”œâ”€ run_cleaning.bat                   # åŸ·è¡Œæ´—å–®æµç¨‹çš„æ‰¹æ¬¡æª”
      â””â”€ upload_to_bigquery.bat             # ä¸Šå‚³è‡³ BigQuery çš„æ‰¹æ¬¡æª”
```

## âš™ï¸ äº‹å‰æº–å‚™èˆ‡å®‰è£ (åªéœ€åŸ·è¡Œä¸€æ¬¡)

åœ¨é–‹å§‹ä½¿ç”¨å‰ï¼Œè«‹ç¢ºä¿æ‚¨çš„é–‹ç™¼ç’°å¢ƒå·²æ»¿è¶³ä»¥ä¸‹æ¢ä»¶ï¼š

1.  **å®‰è£ Python**: ç¢ºèªå·²å®‰è£ Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  **å®‰è£ Google Cloud SDK**:
    - å‰å¾€ [Google Cloud SDK å®‰è£é é¢](https://cloud.google.com/sdk/docs/install) ä¸‹è¼‰ä¸¦å®‰è£ã€‚
    - å®‰è£éç¨‹ä¸­è«‹ç¢ºä¿å‹¾é¸ `bq` å’Œ `gcloud` command-line toolsã€‚
3.  **å»ºç«‹ Python è™›æ“¬ç’°å¢ƒ**:
    - åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„æ‰“é–‹çµ‚ç«¯æ©Ÿ (Command Prompt æˆ– PowerShell)ã€‚
    - åŸ·è¡Œ `python -m venv venv` ä¾†å»ºç«‹è™›æ“¬ç’°å¢ƒã€‚
4.  **å®‰è£ Python å¥—ä»¶**:
    - å»ºç«‹ä¸€å€‹åç‚º `requirements.txt` çš„æª”æ¡ˆï¼Œå…§å®¹å¦‚ä¸‹ï¼š
      ```
      pandas
      openpyxl
      ```
    - åœ¨çµ‚ç«¯æ©Ÿä¸­ï¼Œå…ˆå•Ÿç”¨è™›æ“¬ç’°å¢ƒï¼š`venv\Scripts\activate`
    - æ¥è‘—å®‰è£æ‰€éœ€å¥—ä»¶ï¼š`pip install -r requirements.txt`
5.  **æ”¾ç½® GCP é‡‘é‘°**: å°‡æ‚¨çš„ `shopee-etl-reporting-9531f3a7678a.json` é‡‘é‘°æª”æ¡ˆï¼Œæ”¾ç½®åˆ° `scripts/` è³‡æ–™å¤¾ä¸‹ã€‚

## ğŸš€ æ—¥å¸¸æ“ä½œæµç¨‹

1.  **ä¸‹è¼‰èˆ‡å‘½å**: å¾è¦çš®è³£å®¶ä¸­å¿ƒä¸‹è¼‰è¨‚å–®å ±è¡¨ (`.xlsx` æ ¼å¼)ã€‚ä¸¦å°‡å…¶æ‰‹å‹•é‡æ–°å‘½åç‚ºä»¥ä¸‹æ ¼å¼ï¼š
    > **`åº—é‹ªåç¨±_åº—é‹ªå¸³è™Ÿ_åŸå§‹æª”å.xlsx`**
    >
    > (ç¯„ä¾‹: `æœ‰æ‰å¯µç‰©å•†åº—_yutsai_petmarket_Order.all.20250504_20250603.xlsx`)

2.  **æ”¾ç½®æª”æ¡ˆ**: å°‡é‡æ–°å‘½åå¥½çš„ Excel æª”æ¡ˆæ”¾å…¥ `input/` è³‡æ–™å¤¾ã€‚æ‚¨å¯ä»¥ä¸€æ¬¡æ”¾å…¥å¤šå€‹æª”æ¡ˆã€‚

3.  **åŸ·è¡Œæ¸…æ´—**: é€²å…¥ `scripts/bat_scripts/` è³‡æ–™å¤¾ï¼Œç›´æ¥ **é›™æ“Š** `run_cleaning.bat`ã€‚
    - è…³æœ¬æœƒè‡ªå‹•è™•ç† `input/` ä¸­çš„